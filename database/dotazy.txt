-- == Seznam děl ==

SELECT b.name, b.century, b.category, b.active, b.link, a.firstName, a.lastName 
FROM book b, author a, book_has_author bha
WHERE bha.book_id = b.id_book AND bha.author_id = a.id_author
ORDER BY a.lastName ASC, a.firstName ASC;


-- Seznam děl + jestli je student má v seznamu
SELECT bl.name, bl.century, bl.category, bl.active, bl.link, bl.firstName, bl.lastname, sb.id
FROM 
(SELECT b.id_book, b.name, b.century, b.category, b.active, b.link, a.firstName, a.lastName 
FROM book b, author a, book_has_author bha
WHERE bha.book_id = b.id_book AND bha.author_id = a.id_author
ORDER BY a.lastName ASC, a.firstName ASC) bl 
LEFT JOIN 
(SELECT s.id_student id, b.id_book
FROM student s, book b, student_has_book shb
WHERE s.id_student = shb.student_id AND b.id_book = shb.book_id AND s.id_student = ?) sb
ON bl.id_book = sb.id_book
ORDER BY bl.lastName ASC, bl.firstName ASC;


-- Seznam děl studenta --
SELECT bl.name, bl.century, bl.category, bl.active, bl.link, bl.firstName, bl.lastname, sb.order, sb.state, sb.teachersNote 
FROM 
(SELECT b.id_book, b.name, b.century, b.category, b.active, b.link, a.firstName, a.lastName 
FROM book b, author a, book_has_author bha 
WHERE bha.book_id = b.id_book AND bha.author_id = a.id_author 
ORDER BY a.lastName ASC, a.firstName ASC) bl 
INNER JOIN 
(SELECT s.id_student id, b.id_book, shb.order, shb.state, shb.teachersNote 
FROM student s, book b, student_has_book shb 
WHERE s.id_student = shb.student_id AND b.id_book = shb.book_id AND s.id_student = ?) sb 
ON bl.id_book = sb.id_book 
ORDER BY bl.lastName ASC, bl.firstName ASC; 


-- == Login ==

-- Najdi údaje studenta --
SELECT s.id_student, s.firstName, s.lastName, s.email, s.password
FROM student s
WHERE s.email = ?
LIMIT 1;

-- Najdi údaje učitele --
SELECT t.id_teacher, t.firstName, t.lastName, t.email, t.password
FROM teacher t
WHERE t.email = ?
LIMIT 1;


-- Seznam tříd učitele --
SELECT id_class id, name, lockTime, lockCount FROM class
WHERE teacher_id = ? ORDER BY name;

-- Seznam žáků třídy --
SELECT id_student id, firstName, lastName FROM student
WHERE class_id = ? ORDER BY lastName ASC;